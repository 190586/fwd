var Login=function(){return{initialize:function(a){var b=this;if(a){$("#login-warning").hide();$("#loginform").validate({submitHandler:function(c){b.login()}})}else{$(".sign-out-button").on("click",function(c){c.preventDefault();b.logout()})}},checkLS:function(){try{localStorage.setItem("test","test");localStorage.removeItem("test");return true}catch(a){return false}},logout:function(a){if(this.checkLS()){localStorage.removeItem("t");localStorage.removeItem("r")}else{$.removeCookie("t");$.removeCookie("r")}window.location="/login"},auth:function(a){if(this.checkLS()){if(localStorage.getItem("t")&&localStorage.getItem("r")){a();return}}else{if($.cookie("t")&&$.cookie("r")){a();return}}window.location="/login"},login:function(){var d=this;$("#login-warning").hide();$("#login-button").attr("disabled",true);var c=$("#username").val();var b=$("#password").val();var a="oauth/token?grant_type=password&username="+c+"&password="+b;$.ajax({dataType:"json",type:"GET",url:a,beforeSend:function(e){e.setRequestHeader("Authorization","Basic dGFsZW50czpzZWNyZXQ=")},success:function(e){if(e.access_token!=null){if(d.checkLS()){localStorage.setItem("t",e.access_token);localStorage.setItem("r",e.refresh_token)}else{$.cookie("t",e.access_token);$.cookie("r",e.refresh_token)}window.location="/admin/pages"}},error:function(e){$("#login-warning").show();$("#login-button").attr("disabled",false)}})}}}();